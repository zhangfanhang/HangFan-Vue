import{N as i,q as l,n as P,r as s,o as C,b as V,g as z,e as r,w as n,F as R,d as q,i as D,E as B}from"./index.97ded6be.js";import{r as H}from"./zh-cn.54e2677e.js";import{_ as I,C as O}from"./CommonBtns.c3b1a12c.js";import{_ as j}from"./lodash.6bf63fca.js";import{u as K}from"./user.f6f7b78f.js";import{h as G,g as J}from"./leave.e9c38dc9.js";import{_ as Q}from"./_plugin-vue_export-helper.cdc0426e.js";import"./request.d016c993.js";const W={class:"role-manage"},X={class:"role-manage-from"},Z={class:"role-manage-table"},ee=D("\u62D2 \u7EDD"),ae=D("\u901A \u8FC7"),le={__name:"Approve",setup(te){i.locale("zh-cn"),i.extend(H);const T=K().userInfo.userName;let _=l({});const Y={1:"\u4E8B\u5047",2:"\u8C03\u4F11",3:"\u5E74\u5047"},f=[{label:"\u5F85\u5BA1\u6279",value:1},{label:"\u5BA1\u6279\u4E2D",value:2},{label:"\u5BA1\u6279\u62D2\u7EDD",value:3},{label:"\u5BA1\u6279\u901A\u8FC7",value:4},{label:"\u4F5C\u5E9F",value:5}];l({}),l("create");let m=l(!1),k=l("\u662F\u5426\u901A\u8FC7\u6B64\u4F11\u5047\u7533\u8BF7\uFF1F");const b=l(),A=l();l();const d=l({applyState:""});let p=l({pageSize:10,pageNum:1}),g=l(!0),h=l(0),y=l([]),v=l("");const w=async(e,a)=>{await G({_id:e._id,remark:v.value,action:a}),B.success("\u5BA1\u6838\u6210\u529F"),await u(),m.value=!1},U=()=>{b.value.resetFields(),u()},u=async()=>{g.value=!0;let e={...d.value,...p.value,type:"approve"},{list:a,page:t}=await J(e);h.value=t.total,y.value=a,g.value=!1},x=e=>{p.value.pageSize=e.pageSize,p.value.pageNum=e.currentPage,u()},M=e=>{p.value.pageNum=e,u()};P(()=>{u()});const $=[{label:"\u5355\u53F7",prop:"orderNo",width:"60"},{label:"\u7533\u8BF7\u4EBA",prop:"applyUser.userName",width:"60"},{label:"\u4F11\u5047\u65F6\u95F4",prop:"",width:"60",formatter(e){return`${i(e.startTime).locale("zh-cn").format("YYYY/MM/DD")}~${i(e.endTime).locale("zh-cn").format("YYYY/MM/DD")}`}},{label:"\u4F11\u5047\u65F6\u957F",prop:"leaveTime",width:"60",formatter(e,a,t){return`${t}\u5929`}},{label:"\u4F11\u5047\u7C7B\u578B",prop:"applyType",width:"60",formatter(e,a,t){return Y[t]}},{label:"\u4F11\u5047\u539F\u56E0",prop:"reasons",width:"60"},{label:"\u7533\u8BF7\u65F6\u95F4",prop:"createTime",width:"80",formatter(e,a,t){return i(t).locale("zh-cn").format("YYYY/MM/DD A hh:mm ")}},{label:"\u5BA1\u6279\u4EBA",prop:"auditUsers",width:"60"},{label:"\u5F53\u524D\u5BA1\u6279\u4EBA",prop:"curAuditUserName",width:"60"},{label:"\u5BA1\u6279\u72B6\u6001",prop:"applyState",width:"60",formatter(e,a,t){return f.filter(c=>c.value===t)[0].label}},{width:"100",fixed:"right",showOperation:!0,operationConfig:{type:"button",buttons:[{title:"\u5BA1\u6838",func:e=>{m.value=!0,_.value=j.cloneDeep(e)},link:!0,type:"primary",show:e=>(e.applyState===2||e.applyState===1)&&e.curAuditUserName===T}]}}];return(e,a)=>{const t=s("el-option"),S=s("el-select"),c=s("el-form-item"),E=s("el-form"),F=s("el-input"),N=s("el-button"),L=s("el-dialog");return C(),V("div",W,[z("div",X,[r(E,{inline:!0,model:d.value,ref_key:"elFormRef",ref:b},{default:n(()=>[r(c,{label:"\u5BA1\u6279\u72B6\u6001",prop:"applyState"},{default:n(()=>[r(S,{modelValue:d.value.applyState,"onUpdate:modelValue":a[0]||(a[0]=o=>d.value.applyState=o),placeholder:"\u8BF7\u9009\u62E9\u7528\u6237\u72B6\u6001"},{default:n(()=>[(C(),V(R,null,q(f,o=>r(t,{value:o.value,key:o.value,label:o.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),r(c,null,{default:n(()=>[r(I,{query:u,"re-set":U})]),_:1})]),_:1},8,["model"])]),z("div",Z,[r(O,{ref_key:"commonTableRef",ref:A,tableHeight:450,rowKey:"roleId",selectable:!1,tableData:y.value,columnData:$,currentPage:p.value.pageNum,pageSize:p.value.pageSize,total:h.value,onHandleSizeChange:x,onHandleCurrentChange:M},null,8,["tableData","currentPage","pageSize","total"])]),r(L,{title:k.value,width:"40%",modelValue:m.value,"onUpdate:modelValue":a[4]||(a[4]=o=>m.value=o)},{footer:n(()=>[r(N,{onClick:a[2]||(a[2]=o=>w(_.value,"refuse"))},{default:n(()=>[ee]),_:1}),r(N,{type:"primary",onClick:a[3]||(a[3]=o=>w(_.value,"other"))},{default:n(()=>[ae]),_:1})]),default:n(()=>[r(F,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=o=>v.value=o),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1},8,["title","modelValue"])])}}},_e=Q(le,[["__scopeId","data-v-404d3c4d"]]);export{_e as default};
