import{q as m,n as R,r,o as $,b as j,g as h,e,w as t,L as c,M as _,i as v,E as N,Q as S,z as A,A as H}from"./index.97ded6be.js";import{r as x}from"./request.d016c993.js";import{_ as K,C as P}from"./CommonBtns.c3b1a12c.js";import{u as Q}from"./user.f6f7b78f.js";import{_ as G}from"./_plugin-vue_export-helper.cdc0426e.js";function J(s){return x({url:"/menu/list",method:"get",data:s})}async function M(s){return x({url:"/menu/operate",method:"post",data:s})}const W=s=>(A("data-v-9c441b30"),s=s(),H(),s),X={class:"menu-manage"},Y={class:"menu-manage-from"},Z={class:"menu-manage-table-btns",ref:"testRef"},ee=v("\u521B\u5EFA"),le={class:"menu-manage-table"},ae=W(()=>h("span",{style:{"margin-left":"20px"}},"\u82E5\u4E0D\u9009,\u9ED8\u8BA4\u4E3A\u4E00\u7EA7\u83DC\u5355",-1)),te=v("\u83DC\u5355"),oe=v("\u6309\u94AE"),ue=v("\u6B63\u5E38"),ne=v("\u505C\u7528"),de=v("\u53D6 \u6D88"),re=v("\u786E \u5B9A"),se={__name:"Menu",setup(s){Q();let p=m("create"),i=m(!1),b=m("\u65B0\u589E\u83DC\u5355");const D={menuName:[{required:!0,message:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",trigger:"blur"},{min:2,max:8,message:"\u957F\u5EA6\u57282-8\u4E2A\u5B57\u7B26",trigger:"blur"}]},a=m({parentId:[null],menuType:1,menuState:1}),C=m(),y=m(),f=m({menuName:"",menuState:""});let w=m([]);const E=async()=>{y.value.validate(async n=>{n&&(await M({...a.value,action:p.value}),p.value==="create"?N.success("\u83DC\u5355\u521B\u5EFA\u6210\u529F"):N.success("\u83DC\u5355\u66F4\u65B0\u6210\u529F"),await V(),i.value=!1,location.reload())})},F=()=>{C.value.resetFields(),V()},q=async()=>{i.value=!0,b.value="\u521B\u5EFA\u83DC\u5355",p.value="create",await S(),y.value.resetFields()};R(()=>{V()});const V=async()=>{const n=d=>{d.forEach(u=>{u.menuType===1?u.children&&n(u.children):u.disabled=!0})};let l=await J(f.value);n(l),w.value=l},z=[{label:"\u83DC\u5355\u540D\u79F0",prop:"menuName",width:"110"},{label:"\u56FE\u6807",prop:"icon",width:"110"},{label:"\u83DC\u5355\u7C7B\u578B",prop:"menuType",width:"80",formatter(n,l,d){return{1:"\u83DC\u5355",2:"\u6309\u94AE"}[d]}},{label:"\u6743\u9650\u6807\u8BC6",prop:"menuCode",width:"110"},{label:"\u8DEF\u7531\u5730\u5740",prop:"path",width:"110"},{label:"\u7EC4\u4EF6\u8DEF\u5F84",prop:"component",width:"110"},{label:"\u83DC\u5355\u72B6\u6001",prop:"menuState",width:"80",formatter(n,l,d){return{1:"\u6B63\u5E38",2:"\u505C\u7528"}[d]}},{width:"140",fixed:"right",showOperation:!0,operationConfig:{type:"button",buttons:[{title:"\u65B0\u589E",func:async n=>{if(n.menuType===2){N.error("\u6309\u94AE\u4E0B\u65E0\u6CD5\u65B0\u589E\u83DC\u5355/\u6309\u94AE");return}i.value=!0,b.value="\u521B\u5EFA\u83DC\u5355",p.value="create",await S(),y.value.resetFields(),a.value.parentId=[...n.parentId,n._id].filter(l=>l)},link:!0,type:"primary"},{title:"\u7F16\u8F91",func:async n=>{b.value="\u7F16\u8F91\u83DC\u5355",i.value=!0,p.value="edit",await S(),y.value.resetFields(),Object.assign(a.value,n)},link:!0,type:"primary"},{title:"\u5220\u9664",func:async n=>{p.value="delete",await M({_id:n._id,action:p.value}),await V(),location.reload()},link:!0,type:"danger"}]}}];return(n,l)=>{const d=r("el-input"),u=r("el-form-item"),I=r("el-option"),B=r("el-select"),U=r("el-form"),T=r("el-button"),L=r("el-cascader"),g=r("el-radio"),k=r("el-radio-group"),O=r("el-dialog");return $(),j("div",X,[h("div",Y,[e(U,{inline:!0,model:f.value,ref_key:"elFormRef",ref:C},{default:t(()=>[e(u,{label:"\u83DC\u5355\u540D\u79F0",prop:"menuName"},{default:t(()=>[e(d,{modelValue:f.value.menuName,"onUpdate:modelValue":l[0]||(l[0]=o=>f.value.menuName=o),placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0"},null,8,["modelValue"])]),_:1}),e(u,{label:"\u83DC\u5355\u72B6\u6001",prop:"menuState"},{default:t(()=>[e(B,{modelValue:f.value.menuState,"onUpdate:modelValue":l[1]||(l[1]=o=>f.value.menuState=o),placeholder:"\u8BF7\u9009\u62E9\u83DC\u5355\u72B6\u6001"},{default:t(()=>[e(I,{label:"\u6B63\u5E38",value:1}),e(I,{label:"\u505C\u7528",value:2})]),_:1},8,["modelValue"])]),_:1}),e(u,null,{default:t(()=>[e(K,{query:V,"re-set":F})]),_:1})]),_:1},8,["model"])]),h("div",Z,[e(T,{type:"primary",onClick:q},{default:t(()=>[ee]),_:1})],512),h("div",le,[e(P,{selectable:!1,tableHeight:510,rowKey:"_id",tableData:w.value,columnData:z,pagination:!1},null,8,["tableData"])]),e(O,{title:b.value,width:"40%",modelValue:i.value,"onUpdate:modelValue":l[12]||(l[12]=o=>i.value=o)},{footer:t(()=>[e(T,{onClick:l[11]||(l[11]=o=>i.value=!1)},{default:t(()=>[de]),_:1}),e(T,{type:"primary",onClick:E},{default:t(()=>[re]),_:1})]),default:t(()=>[e(U,{rules:D,model:a.value,"label-width":"80px","label-position":"right",ref_key:"menuInfoTable",ref:y},{default:t(()=>[e(u,{label:"\u7236\u7EA7\u83DC\u5355",prop:"parentId"},{default:t(()=>[e(L,{modelValue:a.value.parentId,"onUpdate:modelValue":l[2]||(l[2]=o=>a.value.parentId=o),options:w.value,props:{checkStrictly:!0,value:"_id",label:"menuName"},clearable:""},null,8,["modelValue","options"]),ae]),_:1}),e(u,{label:"\u83DC\u5355\u7C7B\u578B",prop:"menuType"},{default:t(()=>[e(k,{modelValue:a.value.menuType,"onUpdate:modelValue":l[3]||(l[3]=o=>a.value.menuType=o),disabled:b.value==="\u7F16\u8F91\u83DC\u5355"},{default:t(()=>[e(g,{label:1,size:"large"},{default:t(()=>[te]),_:1}),e(g,{label:2,size:"large"},{default:t(()=>[oe]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),c(e(u,{label:"\u83DC\u5355\u540D\u79F0",prop:"menuName"},{default:t(()=>[e(d,{modelValue:a.value.menuName,"onUpdate:modelValue":l[4]||(l[4]=o=>a.value.menuName=o),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1},512),[[_,a.value.menuType===1]]),c(e(u,{label:"\u6309\u94AE\u540D\u79F0",prop:"menuName"},{default:t(()=>[e(d,{modelValue:a.value.menuName,"onUpdate:modelValue":l[5]||(l[5]=o=>a.value.menuName=o),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1},512),[[_,a.value.menuType===2]]),c(e(u,{label:"\u83DC\u5355\u56FE\u6807",prop:"icon"},{default:t(()=>[e(d,{modelValue:a.value.icon,"onUpdate:modelValue":l[6]||(l[6]=o=>a.value.icon=o),placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u56FE\u6807"},null,8,["modelValue"])]),_:1},512),[[_,a.value.menuType===1]]),c(e(u,{label:"\u8DEF\u7531\u5730\u5740",prop:"path"},{default:t(()=>[e(d,{modelValue:a.value.path,"onUpdate:modelValue":l[7]||(l[7]=o=>a.value.path=o),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u5730\u5740"},null,8,["modelValue"])]),_:1},512),[[_,a.value.menuType===1]]),c(e(u,{label:"\u7EC4\u4EF6\u8DEF\u5F84",prop:"component"},{default:t(()=>[e(d,{modelValue:a.value.component,"onUpdate:modelValue":l[8]||(l[8]=o=>a.value.component=o),placeholder:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u8DEF\u5F84"},null,8,["modelValue"])]),_:1},512),[[_,a.value.menuType===1]]),c(e(u,{label:"\u6743\u9650\u6807\u8BC6",prop:"menuCode"},{default:t(()=>[e(d,{modelValue:a.value.menuCode,"onUpdate:modelValue":l[9]||(l[9]=o=>a.value.menuCode=o),placeholder:"\u8BF7\u8F93\u5165\u6743\u9650\u6807\u8BC6"},null,8,["modelValue"])]),_:1},512),[[_,a.value.menuType===2]]),c(e(u,{label:"\u83DC\u5355\u72B6\u6001",prop:"menuState"},{default:t(()=>[e(k,{modelValue:a.value.menuState,"onUpdate:modelValue":l[10]||(l[10]=o=>a.value.menuState=o)},{default:t(()=>[e(g,{label:1,size:"large"},{default:t(()=>[ue]),_:1}),e(g,{label:2,size:"large"},{default:t(()=>[ne]),_:1})]),_:1},8,["modelValue"])]),_:1},512),[[_,a.value.menuType===1]])]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},ye=G(se,[["__scopeId","data-v-9c441b30"]]);export{ye as default};
